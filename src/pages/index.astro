---
import BaseLayout from "../layouts/BaseLayout.astro";
import BlogPreview from "../components/BlogPreview.astro";
import SocialLinks from "../components/SocialLinks.astro";
import { getCollection } from "astro:content";
import { filterPosts } from "../utils/posts";
import { siteConfig } from "../config";

const posts = await getCollection("blog");

// Configure homepage post filtering
const homePagePosts = filterPosts(posts, {
  ...siteConfig.homepage,
});

const totalPosts = homePagePosts.length;

const hasMorePosts = totalPosts > 3;

const recentPosts = homePagePosts.slice(0, 3);
---

<BaseLayout title={siteConfig.title}>
  <div class="text-left mb-16">
    <h1 class="text-4xl font-bold mb-4 text-gray-900 dark:text-white">
      {siteConfig.slogan}
    </h1>
    <p class="text-xl mb-8 text-gray-600 dark:text-gray-300">
      {siteConfig.description}
    </p>
    <SocialLinks />
  </div>

  <section>
    {homePagePosts.map((post) => <BlogPreview post={post} />)}
  </section>
  {
    hasMorePosts && (
      <div class="flex justify-center mt-12">
        <a
          href="/blog"
          class="px-4 py-2 bg-gray-100 dark:bg-gray-800 rounded hover:bg-gray-200 dark:hover:bg-gray-700"
        >
          View All Posts â†’
        </a>
      </div>
    )
  }
</BaseLayout>
